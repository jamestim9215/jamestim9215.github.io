(function(e){function t(t){for(var a,r,s=t[0],c=t[1],l=t[2],u=0,d=[];u<s.length;u++)r=s[u],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&d.push(o[r][0]),o[r]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);p&&p(t);while(d.length)d.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],a=!0,s=1;s<n.length;s++){var c=n[s];0!==o[c]&&(a=!1)}a&&(i.splice(t--,1),e=r(r.s=n[0]))}return e}var a={},o={app:0},i=[];function r(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=a,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var p=c;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[e.windowOpen?n("div",{staticClass:"window-box-cover"},[n("div",{staticClass:"window-box"},[n("h3",{staticStyle:{"margin-bottom":"15px"}},[e._v("嗨! 請選擇你要找的車位種類!")]),n("select",{attrs:{name:"",id:"initSelectType"}},e._l(e.carType,(function(t,a){return n("option",{key:a,domProps:{value:t.type}},[e._v(" "+e._s(t.name)+" ")])})),0),n("button",{staticClass:"btn",on:{click:e.initCarTypeChange}},[e._v("確定")])])]):e._e(),e._m(0),n("button",{staticClass:"btn btnGetLngLat",class:e.mapOptions.getLngLat?"active":"",on:{click:function(t){e.mapOptions.getLngLat?e.mapOptions.getLngLat=!1:e.mapOptions.getLngLat=!0}}},[e._v(e._s(e.mapOptions.getLngLat?"結束取得座標":"手動取得座標"))]),n("div",{staticClass:"mainInfoBox",class:e.menuActive?"active":""},[n("div",{staticClass:"menuBtn",class:e.menuActive?"active":"",on:{click:function(t){e.menuActive?e.menuActive=!1:e.menuActive=!0}}},[n("div"),n("div"),n("div")]),n("h3",{staticStyle:{padding:"0 25px 0 0"}},[e._v("設定")]),n("h5",[e._v("車種")]),n("select",{staticStyle:{width:"100%","margin-bottom":"10px"},domProps:{value:e.mapOptions.carTypeSelected},on:{change:e.carTypeChange}},e._l(e.carType,(function(t,a){return n("option",{key:a,domProps:{value:t.type}},[e._v(" "+e._s(t.name)+" ")])})),0),n("h5",[e._v("區域")]),n("select",{directives:[{name:"model",rawName:"v-model",value:e.mapOptions.citySelected,expression:"mapOptions.citySelected"}],staticStyle:{width:"calc(50% - 5px)","margin-bottom":"10px"},domProps:{value:e.mapOptions.citySelected},on:{change:[function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.mapOptions,"citySelected",t.target.multiple?n:n[0])},function(t){e.mapOptions.cityAreaSelected=""}]}},e._l(e.areaData,(function(t,a){return n("option",{key:a,domProps:{value:a}},[e._v(" "+e._s(a)+" ")])})),0),n("select",{directives:[{name:"model",rawName:"v-model",value:e.mapOptions.cityAreaSelected,expression:"mapOptions.cityAreaSelected"}],staticStyle:{width:"calc(50% - 5px)","margin-right":"0"},domProps:{value:e.mapOptions.cityAreaSelected},on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.mapOptions,"cityAreaSelected",t.target.multiple?n:n[0])}}},[n("option",{attrs:{value:""}},[e._v("全選")]),e._l(e.areaData[e.mapOptions.citySelected],(function(t,a){return n("option",{key:a,domProps:{value:t}},[e._v(" "+e._s(t)+" ")])}))],2),n("h5",[e._v("地圖樣式")]),n("select",{directives:[{name:"model",rawName:"v-model",value:e.mapOptions.mapStylesSelected,expression:"mapOptions.mapStylesSelected"}],staticStyle:{width:"100%","margin-bottom":"0px"},domProps:{value:e.mapOptions.mapStylesSelected},on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.mapOptions,"mapStylesSelected",t.target.multiple?n:n[0])}}},e._l(e.mapStyle,(function(t,a){return n("option",{key:a,domProps:{value:t.value}},[e._v(" "+e._s(t.name)+" ")])})),0)]),n("div",{staticClass:"mainInfoBox mainInfoBox2",class:e.infoActive?"active":"",attrs:{id:"mainInfoBox2"}},[n("div",{staticClass:"menuBtn",class:e.infoActive?"active":"",style:e.infoActive?"":"opacity: 0",on:{click:function(t){e.infoActive=!1}}},[n("div"),n("div"),n("div")]),n("h3",{staticStyle:{padding:"0 25px 0 0"},attrs:{id:"parkingLotTitle"}}),e._m(1),e._m(2),e._m(3),n("div",{attrs:{id:"parkingLotInfo"}})]),n("pre",{staticClass:"coordinates",attrs:{id:"coordinates"}}),n("MapBox",{attrs:{carType:e.mapOptions.carTypeSelected,getLngLat:e.mapOptions.getLngLat,city:e.mapOptions.citySelected,cityArea:e.mapOptions.cityAreaSelected,mapStylesSelected:e.mapOptions.mapStylesSelected},on:{parkingInfo:e.onSetParkingInfo,userCityArea:e.onSetUserCityArea}})],1)},i=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"appTitle"},[n("h1",[e._v(" 我到底能停哪? ")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._v("地址: "),n("div",{attrs:{id:"parkingLotAddress"}})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._v("營業時間: "),n("div",{attrs:{id:"parkingLotBusinessHours"}})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{attrs:{id:"parkingLotSomeInfo"}})])}],r=(n("99af"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"map"}})}),s=[],c=n("b85c"),l=(n("a9e3"),n("d81d"),n("ac1f"),n("466d"),n("1276"),n("d3b7"),n("25f0"),n("ac6d"),n("e192")),p=n.n(l),u=n("bc3a"),d=n.n(u),m={props:{carType:Number,getLngLat:Boolean,city:String,cityArea:String,mapStylesSelected:String},data:function(){return{map:null,accessToken:"pk.eyJ1IjoiamFtZXN0aW05MjE1IiwiYSI6ImNrdmo2Y2I4aDVmejEzMm1zbThsdGdoajAifQ.UfBJAI7fFsv2wcAEBo6WUA",bounds:[[119.3620389067818,21.83282743468497],[122.07013958372167,25.34391086143183]],center:[121.5173399,25.0475613],currentMarkers:[],userCoordinates:[null,null],lngLatMaker:null,parkingInfo:null,googleDataList:[]}},mounted:function(){this.mapBoxInitial()},watch:{carType:function(){this.setMaker()},city:{handler:function(e,t){e!=t&&this.setMaker()}},cityArea:{handler:function(e,t){e!=t&&this.setMaker()}},getLngLat:function(){if(null!==this.lngLatMaker){this.lngLatMaker.remove();var e=document.getElementById("coordinates");e.style.display="none"}1==this.getLngLat&&this.setLngLatMaker()},mapStylesSelected:{handler:function(e,t){e!=t&&this.map.setStyle(this.mapStylesSelected)}}},methods:{isMatchCarType:function(e,t){var n=!1;for(var a in t)if(t[a]==e){n=!0;break}return n},isMatchArea:function(e){var t=!1;return e.match(this.city)&&e.match(this.cityArea)&&(t=!0),t},isMatchLngLat:function(e){var t=!1;return this.map.transform&&this.map.getBounds()._sw.lng<e[0]&&this.map.getBounds()._ne.lng>e[0]&&this.map.getBounds()._sw.lat<e[1]&&this.map.getBounds()._ne.lat>e[1]&&(t=!0),t},getGoogleData:function(){var e="https://script.google.com/macros/s/AKfycbyF5N0MMaikCNTLiQFS5s73my7lGBhPPadY8B0YfVyrp6hhR-ZZEmzvjq87xwDpzEnOwg/exec",t=this;d.a.get(e).then((function(e){for(var n=e.data,a=1;a<n.length;a++){var o=[];n[a][9].match(/汽車/)&&o.push(1),n[a][9].match(/大型重機/)&&o.push(2),n[a][9].match(/普通重機/)&&o.push(3);var i=n[a][8].split(",");for(var r in i)i[r]=parseFloat(i[r]);var s={imgUrl:n[a][5],properties:{title:n[a][3],info:n[a][4]?n[a][4]:"-",times:n[a][6]?n[a][6]:"-",address:n[a][7],iconSize:[50,50],carInfo:{car:{halfAnHour:n[a][10]?n[a][10].toString():"-",anHour:n[a][11]?n[a][11].toString():"-",dayMax:n[a][12]?n[a][12].toString():"-",other:n[a][13]?n[a][13].toString():"-"},superBike:{halfAnHour:n[a][14]?n[a][14].toString():"-",anHour:n[a][15]?n[a][15].toString():"-",dayMax:n[a][16]?n[a][16].toString():"-",other:n[a][17]?n[a][17].toString():"-"},scooter:{halfAnHour:n[a][18]?n[a][18].toString():"-",anHour:n[a][19]?n[a][19].toString():"-",dayMax:n[a][20]?n[a][20].toString():"-",other:n[a][21]?n[a][21].toString():"-"}},carType:o},geometry:{type:"Point",coordinates:i}};1==n[a][1]&&t.googleDataList.push(s)}var c={type:"",features:t.googleDataList};t.parkingInfo=c,t.setMakerInit();var l=t.center[0]+","+t.center[1];d.a.get("https://api.mapbox.com/geocoding/v5/mapbox.places/"+l+".json?access_token="+t.accessToken).then((function(e){console.log(e.data.features[3].text),t.$emit("userCityArea",e.data.features[3].text)})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e)})).then((function(){}))},setMakerInit:function(){var e=this;this.map.on("dragend",(function(){e.setMaker()})),this.map.on("zoomend",(function(){e.setMaker()})),this.setMaker(),console.log("Map Init!!"),document.getElementById("loading-cover").classList.add("active"),setTimeout((function(){document.getElementById("loading-cover").remove()}),1e3)},setMap:function(){this.map=new p.a.Map({container:"map",style:this.mapStylesSelected,center:this.center,zoom:14,trackResize:!0,maxBounds:this.bounds}),this.getGoogleData(),this.map.addControl(new p.a.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0,showUserHeading:!0}))},mapBoxInitial:function(){var e=this;p.a.accessToken=this.accessToken,"geolocation"in navigator&&navigator.geolocation.getCurrentPosition((function(t){e.userCoordinates[0]=t.coords.longitude,e.userCoordinates[1]=t.coords.latitude,e.center[0]=e.userCoordinates[0],e.center[1]=e.userCoordinates[1];var n=e;n.setMap()}))},setMaker:function(){var e=this;if(null!==this.currentMarkers)for(var t=this.currentMarkers.length-1;t>=0;t--)this.currentMarkers[t].remove();var n,a=Object(c["a"])(this.parkingInfo.features);try{var o=function(){var t=n.value;if(e.isMatchCarType(e.carType,t.properties.carType)&&e.isMatchArea(t.properties.address)&&e.isMatchLngLat(t.geometry.coordinates)){var a=document.createElement("div"),o=t.properties.iconSize[0],r=t.properties.iconSize[1];a.className="marker",a.style.width="".concat(o,"px"),a.style.height="".concat(r,"px");var s=document.createElement("div");s.className="tag",a.append(s);var c=document.createElement("img");c.className="img",c.src="".concat(t.imgUrl),a.append(c),a.addEventListener("click",(function(){e.map.flyTo({center:t.geometry.coordinates,zoom:18,bearing:0,speed:1,curve:1,easing:function(e){return e},essential:!0});var n=t.properties;e.$emit("parkingInfo",n)}));var l=new p.a.Popup({offset:25}).setText(t.properties.title);i=new p.a.Marker(a).setLngLat(t.geometry.coordinates).setPopup(l).addTo(e.map),e.currentMarkers.push(i)}};for(a.s();!(n=a.n()).done;){var i;o()}}catch(r){a.e(r)}finally{a.f()}},onDragEnd:function(){var e=document.getElementById("coordinates"),t=this.lngLatMaker.getLngLat();e.style.display="block",e.innerHTML="[Longitude, Latitude]<br />[".concat(t.lng,", ").concat(t.lat,"]")},setLngLatMaker:function(){this.lngLatMaker=new p.a.Marker({draggable:!0,color:"#2ee7d6"}).setLngLat(this.map.getCenter()).addTo(this.map),this.onDragEnd(),this.lngLatMaker.on("dragend",this.onDragEnd)}}},g=m,v=n("2877"),f=Object(v["a"])(g,r,s,!1,null,"24ac0ba8",null),y=f.exports,h=(n("6672"),n("d065")),S={name:"App",components:{MapBox:y},data:function(){return{windowOpen:!1,menuActive:!1,infoActive:!1,areaData:h,carType:[{type:1,name:"普通小型車"},{type:2,name:"大型重型機車"},{type:3,name:"普通重型機車"}],mapStyle:[{name:"暗色模式",value:"mapbox://styles/jamestim9215/ckvkdj5cd1q4115nzwxa9rny3"},{name:"亮色模式",value:"mapbox://styles/jamestim9215/ckvueghhu2woc14nrsgysx41v"}],mapOptions:{carTypeSelected:1,getLngLat:!1,citySelected:"台北市",cityAreaSelected:"中正區",mapStylesSelected:"mapbox://styles/jamestim9215/ckvkdj5cd1q4115nzwxa9rny3"}}},created:function(){localStorage.getItem("userInitSetCarType")?this.carTypeSelected=parseInt(localStorage.getItem("userInitSetCarType")):this.windowOpen=!0},mounted:function(){},methods:{carTypeChange:function(e){this.mapOptions.carTypeSelected=parseInt(e.target.value)},initCarTypeChange:function(){this.mapOptions.carTypeSelected=parseInt(document.getElementById("initSelectType").value),localStorage.setItem("userInitSetCarType",this.mapOptions.carTypeSelected),this.windowOpen=!1},onSetUserCityArea:function(e){var t=this;for(var n in this.areaData)for(var a in this.areaData[n])if(this.areaData[n][a]==e){this.mapOptions.citySelected=n,setTimeout((function(){t.mapOptions.cityAreaSelected=e}),50);break}},onSetParkingInfo:function(e){document.getElementById("mainInfoBox2").scrollTop=0,document.getElementById("parkingLotTitle").innerText=e.title,document.getElementById("parkingLotAddress").innerText=e.address,document.getElementById("parkingLotBusinessHours").innerText=e.times,document.getElementById("parkingLotSomeInfo").innerHTML=e.info;var t=e.carInfo,n="<hr>";for(var a in t){var o=!1;-1!=e.carType.indexOf(1)&&"car"==a&&(o=!0),-1!=e.carType.indexOf(2)&&"superBike"==a&&(o=!0),-1!=e.carType.indexOf(3)&&"scooter"==a&&(o=!0),n+='\n          <div class="carInfoBox" '.concat(0==o?'style="display:none"':"",">\n            <h4> \n            ").concat("car"==a?"普通小型車":"","\n            ").concat("superBike"==a?"大型重型機車":"","\n            ").concat("scooter"==a?"普通重型機車":"","</h4> \n            ").concat("-"!=t[a].halfAnHour?'<div>半小時 : <span class="infoColor">'+t[a].halfAnHour+"</span></div>":""," \n            ").concat("-"!=t[a].anHour?'<div>1小時 :  <span class="infoColor">'+t[a].anHour+"</span></div>":""," \n            ").concat("-"!=t[a].dayMax?'<div>單日上限 :  <span class="infoColor">'+t[a].dayMax+"</span></div>":""," \n            ").concat("-"!=t[a].other?'<div>詳細資訊: <br> <span class="infoColor">'+t[a].other+"</span></div>":""," \n          </div>\n        ")}document.getElementById("parkingLotInfo").innerHTML=n,this.infoActive=!0}}},k=S,L=Object(v["a"])(k,o,i,!1,null,null,null),_=L.exports;a["a"].config.productionTip=!1,new a["a"]({render:function(e){return e(_)}}).$mount("#app")},6672:function(e,t,n){},d065:function(e){e.exports=JSON.parse('{"台北市":["中正區","大同區","中山區","萬華區","信義區","松山區","大安區","南港區","北投區","內湖區","士林區","文山區"],"新北市":["板橋區","新莊區","泰山區","林口區","淡水區","金山區","八里區","萬里區","石門區","三芝區","瑞芳區","汐止區","平溪區","貢寮區","雙溪區","深坑區","石碇區","新店區","坪林區","烏來區","中和區","永和區","土城區","三峽區","樹林區","鶯歌區","三重區","蘆洲區","五股區"],"基隆市":["仁愛區","中正區","信義區","中山區","安樂區","暖暖區","七堵區"],"桃園市":["桃園區","中壢區","平鎮區","八德區","楊梅區","蘆竹區","龜山區","龍潭區","大溪區","大園區","觀音區","新屋區","復興區"],"新竹縣":["竹北市","竹東鎮","新埔鎮","關西鎮","峨眉鄉","寶山鄉","北埔鄉","橫山鄉","芎林鄉","湖口鄉","新豐鄉","尖石鄉","五峰鄉"],"新竹市":["東區","北區","香山區"],"苗栗縣":["苗栗市","通霄鎮","苑裡鎮","竹南鎮","頭份鎮","後龍鎮","卓蘭鎮","西湖鄉","頭屋鄉","公館鄉","銅鑼鄉","三義鄉","造橋鄉","三灣鄉","南庄鄉","大湖鄉","獅潭鄉","泰安鄉"],"臺中市":["中區","東區","南區","西區","北區","北屯區","西屯區","南屯區","太平區","大里區","霧峰區","烏日區","豐原區","后里區","東勢區","石岡區","新社區","和平區","神岡區","潭子區","大雅區","大肚區","龍井區","沙鹿區","梧棲區","清水區","大甲區","外埔區","大安區"],"南投縣":["南投市","埔里鎮","草屯鎮","竹山鎮","集集鎮","名間鄉","鹿谷鄉","中寮鄉","魚池鄉","國姓鄉","水里鄉","信義鄉","仁愛鄉"],"彰化縣":["彰化市","員林鎮","和美鎮","鹿港鎮","溪湖鎮","二林鎮","田中鎮","北斗鎮","花壇鄉","芬園鄉","大村鄉","永靖鄉","伸港鄉","線西鄉","福興鄉","秀水鄉","埔心鄉","埔鹽鄉","大城鄉","芳苑鄉","竹塘鄉","社頭鄉","二水鄉","田尾鄉","埤頭鄉","溪州鄉"],"雲林縣":["斗六市","斗南鎮","虎尾鎮","西螺鎮","土庫鎮","北港鎮","莿桐鄉","林內鄉","古坑鄉","大埤鄉","崙背鄉","二崙鄉","麥寮鄉","臺西鄉","東勢鄉","褒忠鄉","四湖鄉","口湖鄉","水林鄉","元長鄉"],"嘉義縣":["太保市","朴子市","布袋鎮","大林鎮","民雄鄉","溪口鄉","新港鄉","六腳鄉","東石鄉","義竹鄉","鹿草鄉","水上鄉","中埔鄉","竹崎鄉","梅山鄉","番路鄉","大埔鄉","阿里山鄉"],"嘉義市":["東區","西區"],"臺南市":["中西區","東區","南區","北區","安平區","安南區","永康區","歸仁區","新化區","左鎮區","玉井區","楠西區","南化區","仁德區","關廟區","龍崎區","官田區","麻豆區","佳里區","西港區","七股區","將軍區","學甲區","北門區","新營區","後壁區","白河區","東山區","六甲區","下營區","柳營區","鹽水區","善化區","大內區","山上區","新市區","安定區"],"高雄市":["楠梓區","左營區","鼓山區","三民區","鹽埕區","前金區","新興區","苓雅區","前鎮區","小港區","旗津區","鳳山區","大寮區","鳥松區","林園區","仁武區","大樹區","大社區","岡山區","路竹區","橋頭區","梓官區","彌陀區","永安區","燕巢區","田寮區","阿蓮區","茄萣區","湖內區","旗山區","美濃區","內門區","杉林區","甲仙區","六龜區","茂林區","桃源區","那瑪夏區"],"屏東縣":["屏東市","潮州鎮","東港鎮","恆春鎮","萬丹鄉","長治鄉","麟洛鄉","九如鄉","里港鄉","鹽埔鄉","高樹鄉","萬巒鄉","內埔鄉","竹田鄉","新埤鄉","枋寮鄉","新園鄉","崁頂鄉","林邊鄉","南州鄉","佳冬鄉","琉球鄉","車城鄉","滿州鄉","枋山鄉","霧台鄉","瑪家鄉","泰武鄉","來義鄉","春日鄉","獅子鄉","牡丹鄉","三地門鄉"],"宜蘭縣":["宜蘭市","羅東鎮","蘇澳鎮","頭城鎮","礁溪鄉","壯圍鄉","員山鄉","冬山鄉","五結鄉","三星鄉","大同鄉","南澳鄉"],"花蓮縣":["花蓮市","鳳林鎮","玉里鎮","新城鄉","吉安鄉","壽豐鄉","秀林鄉","光復鄉","豐濱鄉","瑞穗鄉","萬榮鄉","富里鄉","卓溪鄉"],"臺東縣":["臺東市","成功鎮","關山鎮","長濱鄉","海端鄉","池上鄉","東河鄉","鹿野鄉","延平鄉","卑南鄉","金峰鄉","大武鄉","達仁鄉","綠島鄉","蘭嶼鄉","太麻里鄉"],"澎湖縣":["馬公市","湖西鄉","白沙鄉","西嶼鄉","望安鄉","七美鄉"],"金門縣":["金城鎮","金湖鎮","金沙鎮","金寧鄉","烈嶼鄉","烏坵鄉"],"連江縣":["南竿鄉","北竿鄉","莒光鄉","東引鄉"]}')}});
//# sourceMappingURL=app.6d2cb167.js.map