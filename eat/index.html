<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>到底要吃什麼</title>

    <link rel="apple-touch-icon" href="./custom_icon.png">
    <link rel="apple-touch-startup-image" href="./launch.png">
    <meta name="到底要吃什麼" content="AppTitle">
</head>
<style>
body{
    margin: 0 auto;
    background: #fff;
    text-align: center;
}

#selectData{
    position: relative;
    display: inline-block;
    margin: 30px auto;
    width: 100px;
    height: 40px;
    font-size: 16px;
}

.lottery-sector {
    width: 380px;
    height: 380px;
    position: relative;
    margin: 0px auto 30px auto;
    overflow: hidden;
    top: 0;
    border-radius: 50%;
    border: 10px solid #fff;
    box-shadow: 0px 0px 10px #000;
}



.lottery-sector-color{
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1;
    left: 0;
}

.lottery-sector>.lottery-sector-color>span {
    position: absolute;
    left: calc(50% + 1px);
    top: -2px;
    width: 100%;
    height: 50%;
    transform-origin: 0% 100%;
    background-color: #b0e0e6;
    border: 2px solid #fff;
}

.lottery-sector>.lottery-sector-color>span:nth-child(2n){
    background-color: #b0e0e6
}

.lottery-sector>.lottery-sector-color>span:nth-child(2n-1){
    background-color: #e4c6d0
}


.lottery-gift{
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1;
    left: 0;
}

.lottery-gift>span {
    position: absolute;
    display: block;
    width: 100%;
    height: calc(100% - 10px);
    list-style: none;
    padding: 5px 0;
    transform-origin: 50% 50%;
    border: 1px solid rgba(0,0,0,0)
}

.lottery-gift>span div{
    position: relative;
    color: #fff;
    font-size: 16px;
    line-height: 1.2;
    font-weight: bold;
    text-align: center;
    margin: 0 auto;
    width: 20px;
    height: 100%;
}

.lottery-gift>span:nth-child(1) {
    transform: rotate(00deg);
}
.lottery-gift>span:nth-child(2) {
    transform: rotate(60deg);
}
.lottery-gift>span:nth-child(3) {
    transform: rotate(120deg);
}
.lottery-gift>span:nth-child(4) {
    transform: rotate(180deg);
}
.lottery-gift>span:nth-child(5) {
    transform: rotate(240deg);
}
.lottery-gift>span:nth-child(6) {
    transform: rotate(300deg);
}


#triangle{
    position: absolute;
    left: calc(50% - 50px - 10px);
    top: calc(50% - 50px - 10px);
    z-index: 2;
    display: block;
    width: 100px;
    height: 100px;
    border-radius: 50%;
    background: #f19393;
    border: 10px solid #fff;
    box-shadow: 0px 0px 10px #000;
    cursor: pointer;
    /* animation: zhuanzhuanzhuan 4s forwards ease-in-out; */
    /* animation: zhuanzhuanzhuan 4s infinite linear; */
}
#triangle-up {
    position: absolute;
    left: calc(50% - 40px);
    bottom: 70%;
    width: 0;
    height: 0;
    border-left: 40px solid transparent;
    border-right: 40px solid transparent;
    border-bottom: 70px solid #f19393;
}

#output{
    position: relative;
    margin: 0 auto;
    width: 100%;
    text-align: center;
    font-size: 30px;
}

#outputText{
    font-size: 60px;
    font-weight: 700;
}



</style>
<body>
    <select id="selectData" onchange="changeData()">
        <option value="food" selected>食物</option>
        <option value="drink">飲料</option>
    </select>
    
    <div class="lottery-sector" id="lottery-sector">
        <div class="lottery-sector-color" id="lottery-sector-color">
            <!-- <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span> -->
        </div>
        
        <div class="lottery-gift" id="lottery-gift">
            
        </div>
        <div id="triangle" onclick="go()">
            <div id="triangle-up">

            </div>
        </div>
    </div>

    <!-- 結果 -->
    <div id="output">
        今天我想來點<br>
        <div id="outputText"></div>

        --------------
        <br>
        遊戲規則:
        <br><br>
        選到就吃 <br>
        除非店沒開

    </div>

    <script>
        
        let selectData = [
            [
                // { text : '重抽' },
                { text : '花月嵐拉麵' },
                { text : '九湯屋拉麵' },
                { text : '山東水餃王' },
                { text : '高勁牛肉麵' },
                { text : '爭鮮壽司' },
                { text : '定食 8' },
                { text : '大心' },
                { text : '樂昀牛排' },
                { text : '珍宴館' },
                { text : '好享宴小館' },
                { text : '台南虱目魚' },
                { text : '帕米義麵屋' },
                { text : '麵工坊' },
                { text : '吉購吉' },
                { text : '韓國料理' },
                { text : '秋葵犬' },
                { text : '一條通' },
                { text : '龍涎居' },
                { text : '早餐店' },
                { text : '大埔鐵板燒' },
                { text : '一鼎鮮肉羹' },
                { text : '牛肉蓋飯' },
                { text : '薩利亞' },
                { text : '麥當勞' },
                { text : '漢堡王' },
                { text : '角屋鍋燒' },
                { text : '潛艇堡' },
                { text : '越南菜' },
                { text : '客家菜' },
                { text : '八方雲集' },
                { text : '茱蒂漢堡' },
                { text : '野菇屋比薩'},
                { text : '旺達熱炒'}
            ],
            [
                { text : '50 嵐' },
                { text : '麻古茶坊' },
                { text : '水巷茶弄' },
                { text : '乾杯' },
                { text : '茶湯會' },
                { text : '珍煮丹' },
                { text : '不要對我尖叫' },
                { text : '台茶1號' },
                { text : '清心福全' },
            ],
        ];

        let data = []

        function initData(){
            
            document.getElementById('lottery-gift').innerText = '';
            document.querySelectorAll('#lottery-sector-color').innerText = '';
            
            // 隨機順序
            data.sort(function(){return Math.random()>0.5?-1:1;});
            var deg = 0;
            for(var key in data){

                var span = document.createElement('span');

                if(data.length == 1){
                    span.style.width = "100%";
                    span.style.height = "100%";
                    span.style.left = '-2px'; 
                    span.style.top = '-2px'; 
                    span.style.transformOrigin = '50% 50%';
                    span.style.transform = `rotate(0deg) skew(0deg)`;
                }else if(data.length == 2){
                    span.style.width = "100%";
                    span.style.height = "50%";
                    span.style.left = '-2px'; 
                    span.style.top = '-4px'; 
                    span.style.transformOrigin = '50% 100%';
                    span.style.transform = `rotate(${key * 360 / data.length - 0}deg) skew(0deg)`;
                }else{
                    span.style.transform = `rotate(${key * 360 / data.length - ((180 / data.length) - (-90 +  360 / data.length)) }deg) skew(${-90 +  360 / data.length}deg)`;
                }
                if(data.length % 2 != 0){
                    if(key == 0)span.style.backgroundColor = '#ccc'
                }

                document.getElementById('lottery-sector-color').appendChild(span)
                
                var span = document.createElement('span');
                var spanText = document.createElement('div');
                span.style.transform = `rotate(${key * 360 / data.length}deg)`;
                spanText.innerText = data[key].text;
                span.appendChild(spanText);
                document.getElementById('lottery-gift').appendChild(span);
            }
        
        }
        data = selectData[0];
        initData();

        function changeData(){
            var dataType = document.getElementById('selectData').value;
            console.log(dataType);
            switch(dataType){  
                case 'food': data = selectData[0]; break;
                case 'drink': data = selectData[1]; break;
                default: data = selectData[0];
            }

            initData();
            
        }
        

        var gameStatus = false;
        var oldRotate = 0;
        var RotateTime = 1800;
        function go(){
            if(gameStatus == false){
                gameStatus = true;
                var btn = document.getElementById('triangle');
                if(oldRotate > RotateTime){
                    oldRotate = oldRotate - RotateTime;
                }
                btn.style.transform = 'rotate('+oldRotate+'deg)';

                var style = document.createElement('style');
                style.type = 'text/css';
                var random = (Math.floor(Math.random()*360)+ 0);
                var rotate =  parseInt(random + RotateTime);

                var keyFrames = `
                    @keyframes zhuanzhuanzhuan{
                        0%{
                            transform: rotate(${oldRotate}deg);
                        } 
                        100%{
                            transform: rotate(${rotate}deg); 
                        }
                    }
                `;
                style.innerHTML = keyFrames;
                document.getElementsByTagName('head')[0].appendChild(style);
                btn.style.animation = 'zhuanzhuanzhuan 3.5s forwards ease-in-out';
                setTimeout(function(){
                    btn.style.animation = '';
                    oldRotate = rotate;
                    btn.style.transform = 'rotate('+rotate+'deg)';
                    document.getElementsByTagName('head')[0].removeChild(style);
                    var id = Math.round((random  / (360 / data.length)));
                    console.log(id);
                    if(id == data.length){
                        id = 0;
                    }
                    console.log(data[id].text);
                    document.getElementById('outputText').innerText = data[id].text;
                    gameStatus = false;
                },3500);

            }
        }

    </script>

</body>
</html>